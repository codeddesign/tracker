!function(){"use strict";function e(e){var t,n,i,r,o="";for(t=document.createElement("canvas"),t.width=e.width,t.height=e.height,n=t.getContext("2d"),n.drawImage(e,0,0),r=n.getImageData(0,0,t.width,t.height).data,i=0;i<r.length;i+=4)0!==r[i]&&(o+=String.fromCharCode(r[i])),0!==r[i+1]&&(o+=String.fromCharCode(r[i+1])),0!==r[i+2]&&(o+=String.fromCharCode(r[i+2]));return o}function t(e){u("",{},function(){e(this.u)})}function n(){u("/visit",{referer:escape(document.referrer)})}var i={app_path:"http://tracker.dev/track/",cookie_years:5,cookie_name:"sttk_u"},r={connection:null,db:{name:function(){return i.cookie_name+"_db"},size:2097152,table_name:"vuer",table_field:"vid"},hasSupport:function(){return"undefined"!=typeof openDatabase&&(this.connection=openDatabase(this.db.name(),"1.0","",this.db.size),this.connection.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+this.db.table_name+" ('"+this.db.table_field+"')")}.bind(this)),!0)},create:function(e,t){return void 0===t&&(t=!1),!!this.hasSupport()&&void this.read(function(n){return!(n&&!t)&&void this.connection.transaction(function(n){t&&n.executeSql("delete from "+this.db.table_name),n.executeSql("INSERT INTO "+this.db.table_name+" ('"+this.db.table_field+"') VALUES ('"+e+"')")}.bind(this))}.bind(this))},read:function(e){return!!this.hasSupport()&&void this.connection.transaction(function(t){t.executeSql("SELECT "+this.db.table_field+" from "+this.db.table_name,[],function(t,n){return n.rows.length?(e(n.rows[0][this.db.table_field]),!1):void e(!1)}.bind(this))}.bind(this))}},o={hasSupport:function(){return"undefined"!=typeof Storage},create:function(e){return!!this.hasSupport()&&void localStorage.setItem(i.cookie_name,e)},read:function(){if(!this.hasSupport())return!1;var e=localStorage.getItem(i.cookie_name);return!!e&&e}},a={create:function(e){var t=new Date;t.setTime(t.getTime()+24*i.cookie_years*60*60*1e3*365),document.cookie=i.cookie_name+"="+e+"; expires="+t.toGMTString()+"; path=/"},read:function(){var e,t,n=i.cookie_name+"=",r=document.cookie.split(";");for(t=0;t<r.length;t++){for(e=r[t];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(n))return e.substring(n.length,e.length)}return!1}},c=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(n+"="+e[n])}),t.length?"?"+t.join("&"):""},u=function(t,n,u){void 0===t&&(t=""),void 0===n&&(n={}),void 0===u&&(u=function(){});var s=new Image,d=i.app_path.replace(new RegExp("[/]+$"),"");n.u=o.read()||"",s.crossOrigin="use-credentials",s.onload=function(){this.u=e(this),r.create(this.u,!0),o.create(this.u),a.create(this.u),u.call(this)},s.src=d+t+c(n)},s=new Promise(function(e,n){r.read(function(n){var i=a.read(),c=o.read(),u=n||c||i;return u?(n||(c?(r.create(c),a.create(c),n=c):i&&(r.create(i),o.create(i),n=i)),c&&c==n||o.create(n),a.create(n),void e(n)):void t(e)})});s.then(function(e){n()})}();